{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { authActions } from \"_store\";\nimport { fetchWrapper } from \"_helpers\";\n\n// create slice\n\nconst name = \"users\";\nconst initialState = createInitialState();\nconst extraActions = createExtraActions();\nconst extraReducers = createExtraReducers();\nconst slice = createSlice({\n  name,\n  initialState,\n  extraReducers\n});\n\n// exports\n\nexport const userActions = {\n  ...slice.actions,\n  ...extraActions\n};\nexport const usersReducer = slice.reducer;\n\n// implementation\n\nfunction createInitialState() {\n  return {\n    list: null,\n    auditList: null,\n    item: null\n  };\n}\nfunction createExtraActions() {\n  const baseUrl = `${process.env.REACT_APP_API_URL}/users`;\n  return {\n    register: register(),\n    getAll: getAll(),\n    getById: getById(),\n    update: update(),\n    delete: _delete(),\n    audit: audit()\n  };\n  function register() {\n    return createAsyncThunk(`${name}/register`, async user => await fetchWrapper.post(`${baseUrl}/register`, user));\n  }\n  function getAll() {\n    return createAsyncThunk(`${name}/getAll`, async () => await fetchWrapper.get(baseUrl));\n  }\n  function audit() {\n    const body = {\n      role: \"AUDITOR\"\n    };\n    return createAsyncThunk(`${name}/audit`, async user => await fetchWrapper.get(`${baseUrl}/audit`, body));\n  }\n  function getById() {\n    return createAsyncThunk(`${name}/getById`, async id => await fetchWrapper.get(`${baseUrl}/${id}`));\n  }\n  function update() {\n    return createAsyncThunk(`${name}/update`, async function (_ref, _ref2) {\n      let {\n        id,\n        data\n      } = _ref;\n      let {\n        getState,\n        dispatch\n      } = _ref2;\n      await fetchWrapper.put(`${baseUrl}/${id}`, data);\n\n      // update stored user if the logged in user updated their own record\n      const auth = getState().auth.value;\n      if (id === (auth === null || auth === void 0 ? void 0 : auth.id.toString())) {\n        // update local storage\n        const user = {\n          ...auth,\n          ...data\n        };\n        localStorage.setItem(\"auth\", JSON.stringify(user));\n\n        // update auth user in redux state\n        dispatch(authActions.setAuth(user));\n      }\n    });\n  }\n\n  // prefixed with underscore because delete is a reserved word in javascript\n  function _delete() {\n    return createAsyncThunk(`${name}/delete`, async function (id, _ref3) {\n      var _getState$auth$value;\n      let {\n        getState,\n        dispatch\n      } = _ref3;\n      await fetchWrapper.delete(`${baseUrl}/${id}`);\n\n      // auto logout if the logged in user deleted their own record\n      if (id === ((_getState$auth$value = getState().auth.value) === null || _getState$auth$value === void 0 ? void 0 : _getState$auth$value.id)) {\n        dispatch(authActions.logout());\n      }\n    });\n  }\n}\nfunction createExtraReducers() {\n  return builder => {\n    getAll();\n    getById();\n    _delete();\n    audit();\n    function getAll() {\n      var {\n        pending,\n        fulfilled,\n        rejected\n      } = extraActions.getAll;\n      builder.addCase(pending, state => {\n        state.list = {\n          loading: true\n        };\n      }).addCase(fulfilled, (state, action) => {\n        state.list = {\n          value: action.payload\n        };\n      }).addCase(rejected, (state, action) => {\n        state.list = {\n          error: action.error\n        };\n      });\n    }\n    function audit() {\n      var {\n        pending,\n        fulfilled,\n        rejected\n      } = extraActions.getAuditUser;\n      builder.addCase(pending, state => {\n        state.auditList = {\n          loading: true\n        };\n      }).addCase(fulfilled, (state, action) => {\n        state.auditList = {\n          value: action.payload\n        };\n      }).addCase(rejected, (state, action) => {\n        state.auditList = {\n          error: action.error\n        };\n      });\n    }\n    function getById() {\n      var {\n        pending,\n        fulfilled,\n        rejected\n      } = extraActions.getById;\n      builder.addCase(pending, state => {\n        state.item = {\n          loading: true\n        };\n      }).addCase(fulfilled, (state, action) => {\n        state.item = {\n          value: action.payload\n        };\n      }).addCase(rejected, (state, action) => {\n        state.item = {\n          error: action.error\n        };\n      });\n    }\n    function _delete() {\n      var {\n        pending,\n        fulfilled,\n        rejected\n      } = extraActions.delete;\n      builder.addCase(pending, (state, action) => {\n        const user = state.list.value.find(x => x.id === action.meta.arg);\n        user.isDeleting = true;\n      }).addCase(fulfilled, (state, action) => {\n        state.list.value = state.list.value.filter(x => x.id !== action.meta.arg);\n      }).addCase(rejected, (state, action) => {\n        const user = state.list.value.find(x => x.id === action.meta.arg);\n        user.isDeleting = false;\n      });\n    }\n  };\n}","map":{"version":3,"names":["createAsyncThunk","createSlice","authActions","fetchWrapper","name","initialState","createInitialState","extraActions","createExtraActions","extraReducers","createExtraReducers","slice","userActions","actions","usersReducer","reducer","list","auditList","item","baseUrl","process","env","REACT_APP_API_URL","register","getAll","getById","update","delete","_delete","audit","user","post","get","body","role","id","_ref","_ref2","data","getState","dispatch","put","auth","value","toString","localStorage","setItem","JSON","stringify","setAuth","_ref3","_getState$auth$value","logout","builder","pending","fulfilled","rejected","addCase","state","loading","action","payload","error","getAuditUser","find","x","meta","arg","isDeleting","filter"],"sources":["F:/TestPro/simple-login-ui-react-redux/src/_store/users.slice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\n\r\nimport { authActions } from \"_store\";\r\nimport { fetchWrapper } from \"_helpers\";\r\n\r\n// create slice\r\n\r\nconst name = \"users\";\r\nconst initialState = createInitialState();\r\nconst extraActions = createExtraActions();\r\nconst extraReducers = createExtraReducers();\r\nconst slice = createSlice({ name, initialState, extraReducers });\r\n\r\n// exports\r\n\r\nexport const userActions = { ...slice.actions, ...extraActions };\r\nexport const usersReducer = slice.reducer;\r\n\r\n// implementation\r\n\r\nfunction createInitialState() {\r\n  return {\r\n    list: null,\r\n    auditList: null,\r\n    item: null,\r\n  };\r\n}\r\n\r\nfunction createExtraActions() {\r\n  const baseUrl = `${process.env.REACT_APP_API_URL}/users`;\r\n\r\n  return {\r\n    register: register(),\r\n    getAll: getAll(),\r\n    getById: getById(),\r\n    update: update(),\r\n    delete: _delete(),\r\n    audit: audit(),\r\n  };\r\n\r\n  function register() {\r\n    return createAsyncThunk(\r\n      `${name}/register`,\r\n      async (user) => await fetchWrapper.post(`${baseUrl}/register`, user)\r\n    );\r\n  }\r\n\r\n  function getAll() {\r\n    return createAsyncThunk(\r\n      `${name}/getAll`,\r\n      async () => await fetchWrapper.get(baseUrl)\r\n    );\r\n  }\r\n\r\n  function audit() {\r\n    const body = {\r\n      role: \"AUDITOR\",\r\n    };\r\n\r\n    return createAsyncThunk(\r\n      `${name}/audit`,\r\n      async (user) => await fetchWrapper.get(`${baseUrl}/audit`, body)\r\n    );\r\n  }\r\n\r\n  function getById() {\r\n    return createAsyncThunk(\r\n      `${name}/getById`,\r\n      async (id) => await fetchWrapper.get(`${baseUrl}/${id}`)\r\n    );\r\n  }\r\n\r\n  function update() {\r\n    return createAsyncThunk(\r\n      `${name}/update`,\r\n      async function ({ id, data }, { getState, dispatch }) {\r\n        await fetchWrapper.put(`${baseUrl}/${id}`, data);\r\n\r\n        // update stored user if the logged in user updated their own record\r\n        const auth = getState().auth.value;\r\n        if (id === auth?.id.toString()) {\r\n          // update local storage\r\n          const user = { ...auth, ...data };\r\n          localStorage.setItem(\"auth\", JSON.stringify(user));\r\n\r\n          // update auth user in redux state\r\n          dispatch(authActions.setAuth(user));\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  // prefixed with underscore because delete is a reserved word in javascript\r\n  function _delete() {\r\n    return createAsyncThunk(\r\n      `${name}/delete`,\r\n      async function (id, { getState, dispatch }) {\r\n        await fetchWrapper.delete(`${baseUrl}/${id}`);\r\n\r\n        // auto logout if the logged in user deleted their own record\r\n        if (id === getState().auth.value?.id) {\r\n          dispatch(authActions.logout());\r\n        }\r\n      }\r\n    );\r\n  }\r\n}\r\n\r\nfunction createExtraReducers() {\r\n  return (builder) => {\r\n    getAll();\r\n    getById();\r\n    _delete();\r\n    audit();\r\n\r\n    function getAll() {\r\n      var { pending, fulfilled, rejected } = extraActions.getAll;\r\n      builder\r\n        .addCase(pending, (state) => {\r\n          state.list = { loading: true };\r\n        })\r\n        .addCase(fulfilled, (state, action) => {\r\n          state.list = { value: action.payload };\r\n        })\r\n        .addCase(rejected, (state, action) => {\r\n          state.list = { error: action.error };\r\n        });\r\n    }\r\n\r\n    function audit() {\r\n      var { pending, fulfilled, rejected } = extraActions.getAuditUser;\r\n      builder\r\n        .addCase(pending, (state) => {\r\n          state.auditList = { loading: true };\r\n        })\r\n        .addCase(fulfilled, (state, action) => {\r\n          state.auditList = { value: action.payload };\r\n        })\r\n        .addCase(rejected, (state, action) => {\r\n          state.auditList = { error: action.error };\r\n        });\r\n    }\r\n\r\n    function getById() {\r\n      var { pending, fulfilled, rejected } = extraActions.getById;\r\n      builder\r\n        .addCase(pending, (state) => {\r\n          state.item = { loading: true };\r\n        })\r\n        .addCase(fulfilled, (state, action) => {\r\n          state.item = { value: action.payload };\r\n        })\r\n        .addCase(rejected, (state, action) => {\r\n          state.item = { error: action.error };\r\n        });\r\n    }\r\n\r\n    function _delete() {\r\n      var { pending, fulfilled, rejected } = extraActions.delete;\r\n      builder\r\n        .addCase(pending, (state, action) => {\r\n          const user = state.list.value.find((x) => x.id === action.meta.arg);\r\n          user.isDeleting = true;\r\n        })\r\n        .addCase(fulfilled, (state, action) => {\r\n          state.list.value = state.list.value.filter(\r\n            (x) => x.id !== action.meta.arg\r\n          );\r\n        })\r\n        .addCase(rejected, (state, action) => {\r\n          const user = state.list.value.find((x) => x.id === action.meta.arg);\r\n          user.isDeleting = false;\r\n        });\r\n    }\r\n  };\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}