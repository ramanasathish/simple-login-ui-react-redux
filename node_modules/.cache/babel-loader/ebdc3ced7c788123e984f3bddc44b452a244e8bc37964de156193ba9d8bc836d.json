{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport { authActions } from '_store';\nimport { fetchWrapper } from '_helpers';\n\n// create slice\n\nconst name = 'users';\nconst initialState = createInitialState();\nconst extraActions = createExtraActions();\nconst extraReducers = createExtraReducers();\nconst slice = createSlice({\n  name,\n  initialState,\n  extraReducers\n});\n\n// exports\n\nexport const userActions = {\n  ...slice.actions,\n  ...extraActions\n};\nexport const usersReducer = slice.reducer;\n\n// implementation\n\nfunction createInitialState() {\n  return {\n    list: null,\n    item: null\n  };\n}\nfunction createExtraActions() {\n  const baseUrl = `${process.env.REACT_APP_API_URL}/users`;\n  return {\n    register: register(),\n    getAll: getAll(),\n    getById: getById(),\n    update: update(),\n    delete: _delete()\n  };\n  function register() {\n    return createAsyncThunk(`${name}/register`, async user => await fetchWrapper.post(`${baseUrl}/register`, user));\n  }\n  function getAll() {\n    return createAsyncThunk(`${name}/getAll`, async () => await fetchWrapper.get(baseUrl));\n  }\n  function getById() {\n    return createAsyncThunk(`${name}/getById`, async id => await fetchWrapper.get(`${baseUrl}/${id}`));\n  }\n  function update() {\n    return createAsyncThunk(`${name}/update`, async function (_ref, _ref2) {\n      let {\n        id,\n        data\n      } = _ref;\n      let {\n        getState,\n        dispatch\n      } = _ref2;\n      await fetchWrapper.put(`${baseUrl}/${id}`, data);\n\n      // update stored user if the logged in user updated their own record\n      const auth = getState().auth.value;\n      if (id === (auth === null || auth === void 0 ? void 0 : auth.id.toString())) {\n        // update local storage\n        const user = {\n          ...auth,\n          ...data\n        };\n        localStorage.setItem('auth', JSON.stringify(user));\n\n        // update auth user in redux state\n        dispatch(authActions.setAuth(user));\n      }\n    });\n  }\n\n  // prefixed with underscore because delete is a reserved word in javascript\n  function _delete() {\n    return createAsyncThunk(`${name}/delete`, async function (id, _ref3) {\n      var _getState$auth$value;\n      let {\n        getState,\n        dispatch\n      } = _ref3;\n      await fetchWrapper.delete(`${baseUrl}/${id}`);\n\n      // auto logout if the logged in user deleted their own record\n      if (id === ((_getState$auth$value = getState().auth.value) === null || _getState$auth$value === void 0 ? void 0 : _getState$auth$value.id)) {\n        dispatch(authActions.logout());\n      }\n    });\n  }\n}\nfunction createExtraReducers() {\n  return builder => {\n    getAll();\n    getById();\n    _delete();\n    function getAll() {\n      var {\n        pending,\n        fulfilled,\n        rejected\n      } = extraActions.getAll;\n      builder.addCase(pending, state => {\n        state.list = {\n          loading: true\n        };\n      }).addCase(fulfilled, (state, action) => {\n        state.list = {\n          value: action.payload\n        };\n      }).addCase(rejected, (state, action) => {\n        state.list = {\n          error: action.error\n        };\n      });\n    }\n    function getById() {\n      var {\n        pending,\n        fulfilled,\n        rejected\n      } = extraActions.getById;\n      builder.addCase(pending, state => {\n        state.item = {\n          loading: true\n        };\n      }).addCase(fulfilled, (state, action) => {\n        state.item = {\n          value: action.payload\n        };\n      }).addCase(rejected, (state, action) => {\n        state.item = {\n          error: action.error\n        };\n      });\n    }\n    function _delete() {\n      var {\n        pending,\n        fulfilled,\n        rejected\n      } = extraActions.delete;\n      builder.addCase(pending, (state, action) => {\n        const user = state.list.value.find(x => x.id === action.meta.arg);\n        user.isDeleting = true;\n      }).addCase(fulfilled, (state, action) => {\n        state.list.value = state.list.value.filter(x => x.id !== action.meta.arg);\n      }).addCase(rejected, (state, action) => {\n        const user = state.list.value.find(x => x.id === action.meta.arg);\n        user.isDeleting = false;\n      });\n    }\n  };\n}","map":{"version":3,"names":["createAsyncThunk","createSlice","authActions","fetchWrapper","name","initialState","createInitialState","extraActions","createExtraActions","extraReducers","createExtraReducers","slice","userActions","actions","usersReducer","reducer","list","item","baseUrl","process","env","REACT_APP_API_URL","register","getAll","getById","update","delete","_delete","user","post","get","id","_ref","_ref2","data","getState","dispatch","put","auth","value","toString","localStorage","setItem","JSON","stringify","setAuth","_ref3","_getState$auth$value","logout","builder","pending","fulfilled","rejected","addCase","state","loading","action","payload","error","find","x","meta","arg","isDeleting","filter"],"sources":["F:/TestPro/simple-login-ui-react-redux/src/_store/users.slice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\r\n\r\nimport { authActions } from '_store';\r\nimport { fetchWrapper } from '_helpers';\r\n\r\n// create slice\r\n\r\nconst name = 'users';\r\nconst initialState = createInitialState();\r\nconst extraActions = createExtraActions();\r\nconst extraReducers = createExtraReducers();\r\nconst slice = createSlice({ name, initialState, extraReducers });\r\n\r\n// exports\r\n\r\nexport const userActions = { ...slice.actions, ...extraActions };\r\nexport const usersReducer = slice.reducer;\r\n\r\n// implementation\r\n\r\nfunction createInitialState() {\r\n    return {\r\n        list: null,\r\n        item: null\r\n    }\r\n}\r\n\r\nfunction createExtraActions() {\r\n    const baseUrl = `${process.env.REACT_APP_API_URL}/users`;\r\n\r\n    return {\r\n        register: register(),\r\n        getAll: getAll(),\r\n        getById: getById(),\r\n        update: update(),\r\n        delete: _delete()\r\n    };\r\n\r\n    function register() {\r\n        return createAsyncThunk(\r\n            `${name}/register`,\r\n            async (user) => await fetchWrapper.post(`${baseUrl}/register`, user)\r\n        );\r\n    }\r\n\r\n    function getAll() {\r\n        return createAsyncThunk(\r\n            `${name}/getAll`,\r\n            async () => await fetchWrapper.get(baseUrl)\r\n        );\r\n    }\r\n\r\n\r\n    function getById() {\r\n        return createAsyncThunk(\r\n            `${name}/getById`,\r\n            async (id) => await fetchWrapper.get(`${baseUrl}/${id}`)\r\n        );\r\n    }\r\n\r\n    function update() {\r\n        return createAsyncThunk(\r\n            `${name}/update`,\r\n            async function ({ id, data }, { getState, dispatch }) {\r\n                await fetchWrapper.put(`${baseUrl}/${id}`, data);\r\n\r\n                // update stored user if the logged in user updated their own record\r\n                const auth = getState().auth.value;\r\n                if (id === auth?.id.toString()) {\r\n                    // update local storage\r\n                    const user = { ...auth, ...data };\r\n                    localStorage.setItem('auth', JSON.stringify(user));\r\n\r\n                    // update auth user in redux state\r\n                    dispatch(authActions.setAuth(user));\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    // prefixed with underscore because delete is a reserved word in javascript\r\n    function _delete() {\r\n        return createAsyncThunk(\r\n            `${name}/delete`,\r\n            async function (id, { getState, dispatch }) {\r\n                await fetchWrapper.delete(`${baseUrl}/${id}`);\r\n\r\n                // auto logout if the logged in user deleted their own record\r\n                if (id === getState().auth.value?.id) {\r\n                    dispatch(authActions.logout());\r\n                }\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\nfunction createExtraReducers() {\r\n    return (builder) => {\r\n        getAll();\r\n        getById();\r\n        _delete();\r\n\r\n        function getAll() {\r\n            var { pending, fulfilled, rejected } = extraActions.getAll;\r\n            builder\r\n                .addCase(pending, (state) => {\r\n                    state.list = { loading: true };\r\n                })\r\n                .addCase(fulfilled, (state, action) => {\r\n                    state.list = { value: action.payload };\r\n                })\r\n                .addCase(rejected, (state, action) => {\r\n                    state.list = { error: action.error };\r\n                });\r\n        }\r\n\r\n        function getById() {\r\n            var { pending, fulfilled, rejected } = extraActions.getById;\r\n            builder\r\n                .addCase(pending, (state) => {\r\n                    state.item = { loading: true };\r\n                })\r\n                .addCase(fulfilled, (state, action) => {\r\n                    state.item = { value: action.payload };\r\n                })\r\n                .addCase(rejected, (state, action) => {\r\n                    state.item = { error: action.error };\r\n                });\r\n        }\r\n\r\n        function _delete() {\r\n            var { pending, fulfilled, rejected } = extraActions.delete;\r\n            builder\r\n                .addCase(pending, (state, action) => {\r\n                    const user = state.list.value.find(x => x.id === action.meta.arg);\r\n                    user.isDeleting = true;\r\n                })\r\n                .addCase(fulfilled, (state, action) => {\r\n                    state.list.value = state.list.value.filter(x => x.id !== action.meta.arg);\r\n                })\r\n                .addCase(rejected, (state, action) => {\r\n                    const user = state.list.value.find(x => x.id === action.meta.arg);\r\n                    user.isDeleting = false;\r\n                });\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}